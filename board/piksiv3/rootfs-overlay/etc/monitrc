set logfile syslog
# Change the pidfile name as the default conflicts with init.d
# and causes monit to think its already been started
set pidfile /var/run/monit_.pid
set daemon 5

set httpd unixsocket /var/run/monit.sock and
    allow localhost

include /etc/monitrc.d/*.monitrc

check process piksi_system_daemon with pidfile /var/run/piksi_system_daemon.pid
    start program = "/etc/init.d/S82piksi_system_daemon start"
    stop program = "/etc/init.d/S82piksi_system_daemon stop"
    if 1 restarts within 3 cycles then exec "/sbin/reboot -f"

check process sbp_rtcm3_bridge with pidfile /var/run/sbp_rtcm3_bridge.pid
    start program = "/etc/init.d/S82sbp_rtcm3_bridge start"
    stop program = "/etc/init.d/S82sbp_rtcm3_bridge stop"

check process zmq_adapter_rpmsg_piksi100 with pidfile /var/run/zmq_adapter_rpmsg_piksi100.pid
    start program = "/etc/init.d/S83zmq_adapter_rpmsg_piksi100 start"
    stop program = "/etc/init.d/S83zmq_adapter_rpmsg_piksi100 stop"

check process zmq_adapter_rpmsg_piksi101 with pidfile /var/run/zmq_adapter_rpmsg_piksi101.pid
    start program = "/etc/init.d/S83zmq_adapter_rpmsg_piksi101 start"
    stop program = "/etc/init.d/S83zmq_adapter_rpmsg_piksi101 stop"

check process sshd with pidfile /var/run/dropbear.pid
    start program = "/etc/init.d/S50dropbear start"
    stop program = "/etc/init.d/S50dropbear stop"

check process syslogd with pidfile /var/run/syslogd.pid
    start program = "/etc/init.d/S01logging start"
    stop program = "/etc/init.d/S01logging stop"

check process klogd with pidfile /var/run/klogd.pid
    start program = "/etc/init.d/S01logging start"
    stop program = "/etc/init.d/S01logging stop"

check process standalone_file_logger with pidfile /var/run/standalone_file_logger.pid
    start program = "/etc/init.d/S83standalone_file_logger start"
    stop program = "/etc/init.d/S83standalone_file_logger stop"

check process piksi_leds with pidfile /var/run/piksi_leds.pid
    start program = "/etc/init.d/S86piksi_leds start"
    stop program = "/etc/init.d/S86piksi_leds stop"

check process nmea_daemon with pidfile /var/run/nmea_daemon.pid
    start program = "/etc/init.d/S85nmea_daemon start"
    stop program = "/etc/init.d/S85nmea_daemon stop"

check process health_daemon with pidfile /var/run/health_daemon.pid
    start program = "/etc/init.d/S86health_daemon start"
    stop program = "/etc/init.d/S86health_daemon stop"

check process network_daemon with pidfile /var/run/network_daemon.pid
    start program = "/etc/init.d/S86network_daemon start"
    stop program = "/etc/init.d/S86network_daemon stop"
